<button class="refresh-btn" id="refresh-trigger" onclick="runManualRefresh()">Refresh</button>

<script>
    // Updated Refresh Function
    async function runManualRefresh() {
        const btn = document.getElementById('refresh-trigger');
        btn.innerText = "Syncing...";
        btn.disabled = true;

        try {
            // This specifically triggers the fetchDailyHighlights function in your script
            await fetch(API_URL + "?action=refresh", { method: 'POST', mode: 'no-cors' });
            
            // Give the script 2 seconds to finish writing to the sheet, then reload
            setTimeout(() => {
                location.reload();
            }, 2000);
        } catch (e) {
            alert("Refresh failed. Check connection.");
            btn.innerText = "Refresh";
            btn.disabled = false;
        }
    }
</script>
