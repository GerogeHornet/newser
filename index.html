<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        /* ADD TO CSS: Overlay Styles */
        #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:var(--ios-bg); z-index:1000; padding: 20px; box-sizing:border-box; overflow-y:auto; }
        .close-btn { background:var(--ios-accent); color:white; padding:15px; border-radius:12px; text-align:center; font-weight:bold; margin-bottom:20px; cursor:pointer; }
        #overlay-content { font-size: 18px; line-height: 1.6; white-space: pre-wrap; }
    </style>
</head>
<body>

<div id="overlay">
    <div class="close-btn" onclick="document.getElementById('overlay').style.display='none'">Done Reading</div>
    <h2 id="overlay-title"></h2>
    <div id="overlay-content"></div>
</div>

<div class="container">
    </div>

<script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyLYvUaKUZ2QLz0qFtXnl7fbZ7-EyX9w0HLQ-G2Y5hWqBEPPk0GHzzTjebaHdn4ZVupTA/exec";

    // ... (formatTime logic) ...

    async function load() {
        const res = await fetch(API_URL + "?t=" + Date.now());
        const data = await res.json();
        const arts = data.articles;
        
        // ... (Last checked / Empty box logic) ...

        const sections = {
            death: { list: document.getElementById('death-list'), sec: document.getElementById('death-sec'), data: arts.filter(a => a.repeats === -3) },
            notif: { list: document.getElementById('notif-list'), sec: document.getElementById('notif-sec'), data: arts.filter(a => a.repeats === -4) },
            // ... (other sections) ...
        };

        Object.keys(sections).forEach(key => {
            const s = sections[key];
            s.list.innerHTML = '';
            s.sec.style.display = s.data.length ? 'block' : 'none';
            s.data.forEach(item => {
                const div = document.createElement('div');
                const links = JSON.parse(item.link);
                div.className = 'article-card' + ([ -3, -4, -5, -99 ].includes(item.repeats) ? ' red-alert' : '');
                div.innerHTML = `<div class="article-link">${item.title}</div><div class="meta">${formatTime(item.timestamp)}</div>`;
                
                div.onclick = () => {
                    if (item.repeats === -4) {
                        // Open long response in overlay
                        document.getElementById('overlay-title').innerText = item.title;
                        document.getElementById('overlay-content').innerText = links[0].body;
                        document.getElementById('overlay').style.display = 'block';
                    } else {
                        // Open URL for news/death
                        window.open(links[0].link, '_blank');
                    }
                };
                s.list.appendChild(div);
            });
        });
    }

    async function api(a) { await fetch(API_URL+"?action="+a); location.reload(); }
    load();
</script>
</body>
</html>
